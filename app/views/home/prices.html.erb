<% content_for :title, "Market" %>
<div class="container">
  <div class="d-flex no-wrap" style="font-size:1.1rem;">
    <marquee scrollamount="2" onmouseover="this.stop()" onmouseout="this.start()">
    <strong style="color: blue;">Trending Search 24Hr:  </strong>
      <% @top_search["coins"].each do |coin| %>
        <%= image_tag coin["item"]["large"], size:"30" %>
        <%= coin["item"]["name"] %>:
        $<%= coin["item"]["price_btc"].to_d*@prices[0]["current_price"] < 0.001 ? (coin["item"]["price_btc"].to_d*@prices[0]["current_price"]).round(6) : (coin["item"]["price_btc"].to_d*@prices[0]["current_price"]).round(2) %>&nbsp;&nbsp;
      <% end %>
    </marquee>
  </div>

  <div class="table-responsive">
    <table class="table align-middle text-end table-hover mb-0">
      <thead class="align-middle">
        <tr>
          <th class="text-center">Rank</th>
          <th></th>
          <th class="text-start">Name</th>
          <th>Price</th>
          <th>MarketCap</th>
          <th>Circ. Supply</th>
          <th>Total Supply</th>
          <th style="min-width: 90px;">Volume (24Hr)</th>
          <th>Change (24Hr)</th>
        </tr>
      </thead>
      <% @prices.each do |token| %>
        <tbody>
          <td class="text-center"><%= token["market_cap_rank"] %></td>
          <td class="px-0"><%= image_tag token["image"], size:"30" %></td>
          <td class="text-start">
              <%= token["name"] %><br>
              <i style="font-size: 0.8rem;"><%= token["symbol"].upcase %></i>
          </td>
          <td>$<%= token["current_price"] < 0.001 ? number_with_delimiter(token["current_price"].to_d.round(8)) : number_with_delimiter(token["current_price"].round(2)) %></td>
          <td>$<%= number_to_human(token["market_cap"]) %></td>
          <td><%= number_to_human(token["circulating_supply"]) %></td>
          <td><%= number_to_human(token["total_supply"]) %></td>
          <td>$<%= number_to_human(token["total_volume"]) %></td>

          <% if token["price_change_percentage_24h_in_currency"] < 0 %>
            <td style="color: red;">
          <% else %>
            <td style="color: green;">
          <% end %>
            <%= token["price_change_percentage_24h_in_currency"].round(2) %>%
          </td>
      </tbody>
      <% end %>
    </table>
  </div>
</div>
